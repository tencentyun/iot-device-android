<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/601748 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="4481"/>

<div>
<span><div style="text-align: center;"><span style="font-size: 24pt; font-weight: bold;">离线人脸识别SDK瘦身介绍</span></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; font-weight: bold;">一、apk瘦身简述</span></font></div><div><span style="font-size: 14pt;">        离线人脸识别实例Demo中包含了人脸识别全功能实例以及对华捷相机的适配方案实例。so库、模型文件占据了整个apk大小 90%以上的体积，demo apk总大小：74.4MB。用户可以根据自己的需求进行无用依赖包删除，减少人脸识别库在整个apk的大小占比。</span></div><div><font style="font-size: 14pt;"><br/></font></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; font-weight: bold;">二、各个apk能力介绍</span></font></div><div><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 198px;"></col><col style="width: 218px;"></col><col style="width: 194px;"></col><col style="width: 196px;"></col><col style="width: 994px;"></col></colgroup><tbody><tr><td style="width: 198px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">名字</span></div></td><td style="width: 218px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">对应jar/so名字</span></div></td><td style="width: 194px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">对应数据模型名字</span></div></td><td style="width: 196px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">是否必备</span></div></td><td style="width: 994px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">功能描述</span></div></td></tr><tr><td style="width: 198px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">人脸追踪</span></div></td><td style="width: 218px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">YTFaceTracker</span></div></td><td style="width: 194px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">face-tracker</span></div></td><td style="width: 196px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">必备</span></div></td><td style="width: 994px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">快速检测出画面中的人脸， 获得 [人脸大小， 位置， 角度]， 并由此可以进行初步筛选。</span></div></td></tr><tr><td style="width: 198px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">人脸精确配准</span></div></td><td style="width: 218px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">YTFaceAlignment</span></div></td><td style="width: 194px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">face-align</span></div></td><td style="width: 196px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">面部遮挡检测必备</span></div></td><td style="width: 994px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">获得人脸关键点坐标， 以及关键点可见度， 可用于遮挡判断， 表情判断。比如口遮挡罩检测</span></div></td></tr><tr><td style="width: 198px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">人脸质量</span></div></td><td style="width: 218px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">YTFaceQuality</span></div></td><td style="width: 194px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">face-quality</span></div></td><td style="width: 196px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">面部遮挡检测必备</span></div></td><td style="width: 994px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">人脸图片质量打分。</span></div></td></tr><tr><td style="width: 198px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">人脸质量归因</span></div></td><td style="width: 218px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">YTFaceQualityPro</span></div></td><td style="width: 194px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">face-quality-pro</span></div></td><td style="width: 196px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">面部遮挡检测必备</span></div></td><td style="width: 994px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">获得人脸的 [角度，遮挡，模糊，光照] 几个维度的分析结果， 用于进一步筛选。</span></div></td></tr><tr><td style="width: 198px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">YTFaceLiveColor</span></div></td><td style="width: 218px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">YTFaceLiveColor</span></div></td><td style="width: 194px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">face-live-color</span></div></td><td style="width: 196px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">普通摄像头专用</span></div></td><td style="width: 994px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">分析彩色图， 判断图中的人是否活体。 （防止照片， 显示屏等欺骗手段）</span></div></td></tr><tr><td style="width: 198px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">红外活体</span></div></td><td style="width: 218px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">YTFaceLiveIR</span></div></td><td style="width: 194px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">face-live-ir</span></div></td><td style="width: 196px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">红外摄像头专用</span></div></td><td style="width: 994px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">红外摄像头获得的图像与彩色摄像头获得的图像一起分析， 判断摄像头前面的人是否活体。</span></div></td></tr><tr><td style="width: 198px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">深度活体</span></div></td><td style="width: 218px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">YTFaceLive3D</span></div></td><td style="width: 194px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">face-live-3d</span></div></td><td style="width: 196px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">深度摄像头专用</span></div></td><td style="width: 994px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">深度摄像头获得的图像与彩色摄像头获得的图像一起分析， 判断摄像头前面的人是否活体。</span></div></td></tr><tr><td style="width: 198px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">人脸提特征</span></div></td><td style="width: 218px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">YTFaceFeature</span></div></td><td style="width: 194px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">face-feature</span></div></td><td style="width: 196px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">仅实现人脸捕捉可删除</span></div></td><td style="width: 994px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">提取人脸特征， 并可进行人脸 1：1 比对（比较 2 个人脸相似度， 判断是否同一人）， 提特征同时也是 1：N 检索的前置条件。</span></div></td></tr><tr><td style="width: 198px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">人脸 1：N 检索</span></div></td><td style="width: 218px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">YTFaceRetrieval</span></div></td><td style="width: 194px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">无</span></div></td><td style="width: 196px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">仅实现人脸捕捉可删除</span></div></td><td style="width: 994px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">从人脸库中找出与给定的人脸最相似的若干个结果， 判断给定的人脸是谁。此外还要人脸库管理功能（增删查改）。</span></div></td></tr><tr><td style="width: 198px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">人脸识别授权</span></div></td><td style="width: 218px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">Common</span></div></td><td style="width: 194px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">无</span></div></td><td style="width: 196px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">必备</span></div></td><td style="width: 994px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">用于对人脸识别SDK授权功能的必备包</span></div></td></tr><tr><td style="width: 198px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">图像编码格式转换</span></div></td><td style="width: 218px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">Utils</span></div></td><td style="width: 194px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">无</span></div></td><td style="width: 196px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">必备</span></div></td><td style="width: 994px; padding: 8px; border: 1px solid;"><div><span style="font-size: 12pt;">用于对捕捉的图像转换成人脸识别所需要的编码格式。</span></div></td></tr></tbody></table><div><br/></div></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; font-weight: bold;">三、相关代码介绍</span></font></div><div><span style="font-size: 14pt;">         1、所有的人脸识别功能so库初始化在YTSDKManager类中</span></div><div><span style="font-size: 14pt;">         2、有关人脸识别调用的逻辑在HeavyThread与TrackThread中。每个so库的功能在这两个类中封装成了独立的任务实体变量。变量命名规则：XXXXTask</span></div><div><span style="font-size: 14pt;">         3、华捷摄像头(红外、深度摄像头)相关的实例实现封装在lib-imi-camera模块中。</span></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; font-weight: bold;">四、瘦身步骤</span></font></div><div><span style="font-size: 14pt;">        1、删除对应的so库、jar包、assets/XX 模型文件目录。</span></div><div><span style="font-size: 14pt;">        2、</span><span style="font-size: 14pt;">YTSDKManager类需要进行的操作：</span></div><div><span style="font-size: 14pt;">                2.1、loadModels()方法中删除对应的模块初始化代码。</span></div><div><span style="font-size: 14pt;">                2.2、loadLibs()方法中删除对应的so库初始化代码。</span></div><div><span style="font-size: 14pt;">                2.3、若不使用人脸特征提取、人脸检索功能</span><span style="font-size: 14pt;">删除extractFaceFeature(..)方法、CompareFaceActivity类。</span></div><div><span style="font-size: 14pt;">                2.4、</span><span style="font-size: 14pt;">删除本类中其他报红代码。</span></div><div><span style="font-size: 14pt;">        3、HeavyThread、TrackThread类中：</span></div><div><span style="font-size: 14pt;">                3.1、HeavyWorkingOptions枚举 删除对应功能的字段。</span></div><div><span style="font-size: 14pt;">                3.2、删除对应功能的XXXTask变量。</span></div><div><span style="font-size: 14pt;">                3.3、做完前两步后，对createPipeline()方法中的报红代码块进行删除。</span></div><div><span style="font-size: 14pt;">                3.4、删除其他报红代码以及无引用方法。</span></div><div><span style="font-size: 14pt;">        4、删除其他类的报红代码以及对应的逻辑。</span></div><div><span style="font-size: 14pt;">        5、针对非华捷相机或者其他非红外、深度摄像头的运用场景瘦身额外操作：</span></div><div><span style="font-size: 14pt;">                5.1、settings.gradle、app/build.gradle文件中删除lib-imi-camera模块引用。</span></div><div><span style="font-size: 14pt;">                5.2、打开项目根目录删除lib-imi-camera文件夹。</span></div><div><span style="font-size: 14pt;">                5.3、app模块中删除ImiCameraActivity、ImiCameraViewController类以及AndroidManifest文件中对应的activity注册代码。</span></div><div><br/></div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; font-weight: bold;">五、经典案例</span></font></div><div><span style="font-size: 14pt;">       1、普通摄像头仅进行人脸捕捉+面部遮挡判断+彩色活体检测需求：</span></div><div><span style="font-size: 14pt;">  </span> <span style="font-size: 14pt;">         1）so/jar依赖库选择：</span><span style="font-size: 14pt;">Common、Utils、</span><span style="font-size: 14pt;">YTFaceTracker、YTFaceAlignment、</span> <span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 14pt; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">YTFaceQuality、</span> <span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 14pt; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">YTFaceQualityPro、</span><span style="font-size: 14pt;">YTFaceLiveColor</span></div><div><span style="font-size: 14pt;">            2）删除lib-imi-camera</span></div><div><span style="font-size: 14pt;">        2、普通摄像头仅进行人脸捕捉需求(非精确捕捉)：</span></div><div><span style="font-size: 14pt;">            1）so/jar依赖库选择： </span><span style="font-size: 14pt;">Common、Utils、YTFaceTracker</span></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt;">            </span></font><span style="font-size: 14pt;">2）删除</span><span style="font-size: 14pt;">lib-imi-camera</span></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt;">        3、</span></font><span style="font-size: 14pt;">普通摄像头进行人脸识别捕捉、质量检测、活体验证、注册于检索：</span></div><div><span style="font-size: 14pt;">            1）</span><span style="font-size: 14pt;">so/jar依赖库选择：</span><span style="font-size: 14pt;">Common、Utils、</span><span style="font-size: 14pt;">YTFaceTracker、YTFaceAlignment、</span> <span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 14pt; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">YTFaceQuality、</span> <span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 14pt; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">YTFaceQualityPro、</span><span style="font-size: 14pt;">YTFaceLiveColor、</span><span style="font-size: 12pt;">YTFaceFeature、</span><span style="font-size: 12pt;">YTFaceRetrieval</span></div><div><span style="font-size: 12pt;">              </span><span style="font-size: 14pt;">2）删除</span><span style="font-size: 14pt;">lib-imi-camera</span></div><div><font style="font-size: 16pt;"><br/></font></div><div><font style="font-size: 16pt;"><br/></font></div><div><font style="font-size: 16pt;"><br/></font></div><div><br/></div><div><font style="font-size: 16pt;"><br/></font></div><div><font style="font-size: 16pt;"><br/></font></div><div><font style="font-size: 16pt;"><br/></font></div><div><font style="font-size: 16pt;"><br/></font></div><div><font style="font-size: 16pt;"><br/></font></div><div><font style="font-size: 16pt;"><br/></font></div><div><font style="font-size: 16pt;"><br/></font></div></span>
</div></body></html> 